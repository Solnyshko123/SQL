Могут включаться в WHERE или HAVING:
- WHERE | HAVING выражение оператор_сравнения (вложенный запрос);
- WHERE | HAVING выражение, включающее вложенный запрос;
- WHERE | HAVING выражение [NOT] IN (вложенный запрос);
- WHERE | HAVING выражение  оператор_сравнения  ANY | ALL (вложенный запрос)

**Вложенный запрос, возвращающий одно значение**

WHERE + операции сравнения

Пример:

  SELECT author, title, price
  
  FROM book
  
  WHERE price <= 
      
      (SELECT AVG(price)
      
      FROM book)
  
  ORDER BY price DESC;

**Использование вложенного запроса в выражении**

Пример:
  SELECT author, title, price

  FROM book

  WHERE ABS(price - (SELECT MIN(price) FROM book)) <= 150

  ORDER BY price;

**Оператор IN**

WHERE <имя_столбца> IN (вложенный запрос, возвращающий один столбец)

Пример:

  SELECT  author, title, amount

  FROM book

  WHERE amount IN(
    
      SELECT amount 
    
      FROM book
    
      GROUP BY amount
    
      HAVING COUNT(amount) = 1);

**Операторы ANY и ALL**

ANY и ALL используются  в SQL для сравнения некоторого значения с результирующим набором вложенного запроса, состоящим из одного столбца:

При ANY в таблицу будут включены все записи, для которых  выражение со знаком отношения верно хотя бы для одного элемента результирующего запроса:
- amount > ANY (10, 12) эквивалентно amount > 10
- amount < ANY (10, 12) эквивалентно amount < 12
- amount = ANY (10, 12) эквивалентно (amount = 10) OR (amount = 12), а также amount IN  (10,12)
- amount <> ANY (10, 12) вернет все записи с любым значением amount, включая 10 и 12
  
При ALL в таблицу будут включены все записи, для которых  выражение со знаком отношения верно для всех элементов результирующего запроса:
- amount > ALL (10, 12) эквивалентно amount > 12
- amount < ALL (10, 12) эквивалентно amount < 10
- amount = ALL (10, 12) не вернет ни одной записи, так как эквивалентно (amount = 10) AND (amount = 12)
- amount <> ALL (10, 12) вернет все записи кроме тех,  в которых amount равно 10 или 12

Кратко: > - ALL, < - ANY.

Операторы ALL и ANY можно использовать только с вложенными запросами.

Пример:
  
  SELECT author, title, price
  
  FROM book
  
  WHERE price < ANY(
      
      SELECT MIN(price)
      
      FROM book
      
      GROUP BY author);

**Вложенный запрос после SELECT**

В этом случае результат выполнения запроса выводится в отдельном столбце результирующей таблицы. При этом результатом запроса может быть только одно значение, тогда оно будет повторяться во всех строках. Также вложенный запрос может использоваться в выражениях.

Пример: Посчитать сколько и каких экземпляров книг нужно заказать поставщикам, чтобы на складе стало одинаковое количество экземпляров каждой книги, равное значению самого большего количества экземпляров одной книги на складе. Вывести название книги, ее автора, текущее количество экземпляров на складе и количество заказываемых экземпляров книг. Последнему столбцу присвоить имя Заказ. В результат не включать книги, которые заказывать не нужно.
  
  SELECT title, author, amount, (
          
          SELECT MAX(amount)
          
          FROM book
          
          ) - amount AS Заказ
  
  FROM book
  
  WHERE amount < (SELECT MAX(amount) FROM book);

